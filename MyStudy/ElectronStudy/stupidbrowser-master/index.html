<head>
  <meta charset="utf-8">
  <title>My Stupid Browser</title>
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/index.css">
  <script type="text/javascript" src="js/main.js"></script>
</head>
  <body>
<div class="container">
    <h1>My Stupid Browser</h1>
<form>
    <div>
        <label for="urllabel">URL</label>
        <input  id="myurltext" class="u-full-width" placeholder="https://www.google.com" type="text" autofocus>
      </div>
      <div>
          <button type="submit">Go!</button>
      </div>
    </form>

<webview id="mainwebview" nodeintegration="on"  src="https://www.google.com" style="display:inline-flex; width:900px; height:680px" partition="persist:sitesession" allowpopups>
<div class = "indicator"> </div>
</webview>

<script>
onload = () => {

     const webv = document.getElementById('mainwebview')
     webv.addEventListener('dom-ready', () => {
      let currentURL = webv.getURL();
     document.getElementById('myurltext').value = currentURL;
     })

     document.querySelector('form').addEventListener('submit', (event) =>{
         event.preventDefault();

//     const urlin = document.querySelector('urltext').innerText;

  //  const {value} = document.querySelector('urltext');
  //  alert(value);
         const newurl = document.getElementById('myurltext').value;
         proxyConfig  = {
             proxyRules:"socks5://134.175.38.75:1080",
             proxyBypassRules:"127.0.0.1,www.baidu.com"
         };
         webv.webContents.session.setProxy(proxyConfig, function () {   webv.loadURL(newurl); });
         //webv.createSession().setpr
        //webv.loadURL(newurl);
  //   webv.src = urlin;
    });

}

</script>


</body>
